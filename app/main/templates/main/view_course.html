{% extends "base.html" %} {% block title %}{{ course.title }}{% endblock %} {%
block content %}

<div class="course-container">
  <section class="course-hero">
    <div class="course-hero-left">
      <h1>{{ course.title }}</h1>
      <p class="muted">
        <strong>Course Code:</strong> {{ course.code if course.code else "N/A"
        }}
      </p>
      {% if course.description %}
      <p class="course-desc">{{ course.description }}</p>
      {% endif %}
    </div>
    <div class="course-hero-actions">
      <a
        href="{{ url_for('main.view_course', course_id=course.id) }}"
        class="btn-secondary"
        >Details</a
      >
      <a href="{{ url_for('main.create_assignment') }}" class="btn-create"
        >+ New Assignment</a
      >
      <a href="{{ url_for('main.classes') }}" class="btn">Back</a>
    </div>
  </section>

  <div class="course-grid">
    <main class="course-main">
      <h2>Assignments</h2>
      {% if assignments and assignments|length > 0 %}
      <ul class="assignments-list course-assignments">
        {% for assignment in assignments %}
        <li class="assignment-item">
          <div class="assignment-card">
            <div class="assignment-card-header">
              <h3 class="assignment-title">{{ assignment.title }}</h3>
              <span class="assignment-due">Due: {{ assignment.due_date }}</span>
            </div>
            {% if assignment.description %}
            <p class="assignment-desc">{{ assignment.description }}</p>
            {% endif %}
            <div class="assignment-meta">
              {% if assignment.course %}
              <span class="meta-pill"
                >Course: {{ assignment.course.title }}</span
              >
              {% else %}
              <span class="meta-pill meta-warning">Unlinked</span>
              {% endif %}
            </div>
          </div>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p>No assignments for this course yet.</p>
      {% endif %}
    </main>

    <aside class="course-sidebar">
      <div class="sidebar-card">
        <h3>Enrolled Students</h3>
        {% if students and students|length > 0 %}
        <ul class="students-list">
          {% for student in students %}
          <li class="student-item">
            <strong>{{ student.username }}</strong>
            <div class="small muted">{{ student.email }}</div>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p>No students enrolled in this course yet.</p>
        {% endif %}
      </div>

      <div class="sidebar-card">
        <h3>Add a Student</h3>
        <form
          method="POST"
          action="{{ url_for('main.enroll_student', course_id=course.id) }}"
        >
          {{ form.hidden_tag() }}
          <div class="form-field">
            <label for="student_identifier"
              >{{ form.student_identifier.label.text }}</label
            >
            {{ form.student_identifier(id='student_identifier', size=30,
            class_='input') }} {% for error in form.student_identifier.errors %}
            <div class="error">{{ error }}</div>
            {% endfor %}
          </div>
          <div>{{ form.submit(class_='btn-primary') }}</div>
        </form>
      </div>
    </aside>
  </div>
</div>

{% endblock %}
